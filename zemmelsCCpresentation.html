<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>cmcR: An open-source implementation of the Congruent Matching Cells method</title>
    <meta charset="utf-8" />
    <meta name="author" content="Joseph Zemmels" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# <code>cmcR</code>: An open-source implementation of the Congruent Matching Cells method
## Creative Component Oral Exam
### Joseph Zemmels
### Iowa State University
### 4/13/20

---

&lt;style&gt;
pre {
    display: block;
    font-family: monospace;
    white-space: pre;
    margin: 1em 0px;
    margin-top: 0em;
    margin-right: 0px;
    margin-bottom: 0em;
    margin-left: 0px;
}
&lt;/style&gt;





#Overview

 - Motivation and Background Information
 
 - Pre-processing procedures
 
 - Cell-based comparison procedure
 
 - Congruent Matching Cells logic
 
 - Results &amp; Discussion
 
 - Conclusion and Future Work

???
- This main goal of this project was to implement the Congruent Matching Cells method as originally proposed by John Song in 2013 as well as one improvement to the method proposed by Tong and others in 2015. The implementation is provided in the form of the `cmcR` package, currently available for download off of my Github.

- My plan for this presentation is to:
 - First introduce the problem and provide some exposition about the CMC method that will be expanded upon later
 - Discuss pre-processing steps that need to be performed on the cartridge case data in order to make the method work properly
 - Talk about the features we extract from the data for use in the method
 - Talk deeper about how we use the extracted features to make classification of matching vs. non-matching cartridge cases
 - Discuss results obtained from applying the method to commonly used cartridge case data in the CMC literature
 - Provide final conclusions and discuss future work

- While discussing various methods, I will be referring to associated functions in the `cmcR` package throughout the presentation. 

---
class: inverse, center, middle

# Motivation &amp; Background Information

---

# Anatomy of a cartridge case

.pull-left[
1) Bullet

2) Cartridge case

3) Propellant

4) Rim

5) Primer
]

.pull-right[
&lt;img src="images/cartridgeCaseDiagram.png" width="330" style="display: block; margin: auto 0 auto auto;" /&gt;
]

.footnote[
[Image Source](https://commons.wikimedia.org/wiki/File:Bulletfixed.PNG)
]

???
- First, it's important to understand some common terminology.
- The diagram shows the entirety of what we might colloquially refer to as a "bullet." However, the bullet is actually only the projectile stored at the tip of the overall cartridge.
- We are most interested in the base of the cartridge case. In particular, the area around the primer.
- The primer is the region that is struck by the firing pin during the firing process.

---

# Breech face impressions

 - During firing process, cartridge case hits back wall (*breech face*) of barrel

 - Contact often "stamps" breech face markings onto cartridge case primer/base
 
.pull-left[
&lt;img src="images/firearmBreechFace.png" width="400" height="300" style="display: block; margin: auto 0 auto auto;" /&gt;
]

.pull-right[
&lt;img src="images/cartridgeCasePrimer.png" width="400" height="300" style="display: block; margin: auto 0 auto auto;" /&gt;
]

.footnote[
[Images Source](http://www.firearmsid.com/A_CCIDImpres.htm)
]

???
- During the firing process, as a bullet is propelled down the barrel of a firearm, the rest of the cartridge is sent backwards in response.
- The base of the cartridge case slams against the back wall, referred to as the breech face, of the firearm's barrel.
- Any markings left on the breech face due to, e.g., the manufacturing process can be "stamped" into the metal of the cartridge case base and primer.
- The two images illustrate this. The left image shows the breech face of a 12 gauge shotgun. We can clearly see some markings on this breech face.
 - The right image shows the primer of a spent cartridge case fired from this 12 gauge shotgun. We can see that some of the markings of the breech face have been imprinted onto this cartridge case.
- It has long been believed that a cartridge case can be matched to the firearm from which it was fired based on these breech face impressions. In particular, we may have a "questioned" cartridge case of unknown source that we can compare to a known-source cartridge case.

---
#Breech face vs. firing pin impressions

&lt;img src="images/primerBFImpressionDiagram.png" width="351" style="display: block; margin: auto;" /&gt;

.footnote[
[Image Source](https://pdfs.semanticscholar.org/f2ab/001b090f2fcb79eff7a83b8aafeb81909944.pdf?_ga=2.260252488.476104195.1585242193-1176892230.1581362963)
]

???
- To match two cartridge cases, we are interested in comparing their breech face impressions.
- The image here shows that the breech face impression region of interest is actually rather small compared to the overall cartridge case base.
- Additionally, the impression left by the firing pin striking the primer is contained by the breech face impression region.
- Classifying matches based on markings left by the firing pin impression has also been explored. However, firing pin impressions are not the focus of the Congruent Matching Cells method.
---
# Cartridge case surface matrices


```r
fadul1.1 &lt;- x3ptools::read_x3p("data/Fadul 1-1.x3p")
```


&lt;img src="zemmelsCCpresentation_files/figure-html/unnamed-chunk-104-1.png" style="display: block; margin: auto;" /&gt;

.footnote[
[Data Source](https://tsapps.nist.gov/NRBTD/Studies/Studies/Details/e7a8aab8-8d5a-44ac-b2be-f0de7c2ca505?nm=True&amp;mt=1&amp;m=3&amp;sp=1)
]

???
- Cartridge case data typically come in two forms: optical 2D images and 3D topographical scans.
- It has been demonstrated by a number of authors that the 3D scans are easier to classify as matches vs. non-matches than the 2D images. The `cmcR` package was written to interface with the topographical scans.
- Many of these cartridge case scans are openly available from the NIST Ballistics and Toolmarks Research Database. The data are commonly stored in an XML 3D Surface Profile or .x3p file format. - The cartridge case data are represented in the .x3p file via a *surface matrix*. This is a single spatially-ordered matrix whose elements represent height values in micrometers or *microns* at a particular location. It is these surface matrices with which we work directly when classifying matches.
- The `x3ptools` package in `R` can be used to interface with  .x3p files. The code shown will read an .x3p file into `R` and display it in 3D using a local `rgl` device. 
- The plot shown, while not the output of the `image_x3p` function, shows the contents of the surface matrix where height values are mapped to grayscale. Note that lighter colored pixels represent higher values than darker pixels. 

---

# Congruent Matching Cells method

 - Some regions of cartridge case contain strong *ballistic signature*
 
 - Comparing entire scans may not highlight "valid correlation areas"&lt;sup&gt;[1]&lt;/sup&gt;
 
 - Number of matching cells is a more granular similarity metric

&lt;img src="images/im1_im2_cellComparison.png" width="567" style="display: block; margin: auto;" /&gt;

.footnote[
&lt;!-- [1] [Song (2013)](https://tsapps.nist.gov/publication/get_pdf.cfm?pub_id=910868) --&gt;
[1] Song [Son13]
]

---
#Congruent Matching Cells method

- Two cartridge case scans can be rotationally and translationally aligned.
 
    - `\(\pmb{\beta} \equiv (dx,dy,\theta)' \in \mathbb{R} \times \mathbb{R} \times [0,2\pi)\)` aligns Matrix 1 to Matrix 2

- Cartridge case's cells can also be aligned

    - `\(\pmb{\beta}_i \equiv (dx_i,dy_i,\theta_i)', i = 1,...,n\)` for `\(n\)` total cells

--

- We expect `\(\pmb{\beta}_i = \pmb{\beta}, \forall i = 1,...,n\)` for true matches
 
- It's much easier to determine whether `\(\hat{\pmb{\beta}}_i \approx \hat{\pmb{\beta}}_j, i \neq j\)`
 
--
 
- Use estimated alignment parameters, `\(\hat{\pmb{\beta}}_i\)`, as features to classify matches 

---
#Congruent Matching Cells method

![](images/bfRotationComparison.gif)&lt;!-- --&gt;

---
class: inverse, middle, center

# Pre-processing procedures

---

# Pre-processing goals

1) Remove regions of scan that do not contain breech face impressions
 
- Preferably do so automatically
     
2) Highlight remaining breech face impressions via Gaussian filtering
 

&lt;img src="images/bfImpressionHighlighted.png" width="340" style="display: block; margin: auto;" /&gt;

---

# 1. Identify BF impression height value

- RANSAC&lt;sup&gt;[1]&lt;/sup&gt; (Random Sample Consensus) robust, iterative plane-fitting
    
&lt;img src="images/ransacMethod.png" width="455" style="display: block; margin: auto;" /&gt;

.footnote[
[1] Fischler and Bolles [FB81], [Image Source](https://bitesofcode.wordpress.com/tag/opencv/)
]

---

#1. Identify BF impression height value

- Use RANSAC method to identify BF impression height value in scan

    - Take residuals between fitted plane and observed values within the final selection threshold specified
    
    - Or, take observed values within final selection threshold



---
#1. Identify BF impression height value

- Note: relies on randomly sampling surface matrix, so results may differ between uses

&lt;img src="zemmelsCCpresentation_files/figure-html/unnamed-chunk-110-1.png" style="display: block; margin: auto;" /&gt;

---
#2. Removing "minutiae"

- Crop-out whitespace exterior to cartridge case scan


&lt;img src="zemmelsCCpresentation_files/figure-html/unnamed-chunk-112-1.png" style="display: block; margin: auto;" /&gt;


---
#2. Removing "minutiae" - Hough transform

- Need to "detect" firing pin impression circle in arbitrary scan

    &lt;!-- - Note: Glocks have rectangular firing pins, so doesn't necessarily generalize --&gt;
    
- Hough transform&lt;sup&gt;[1]&lt;/sup&gt; voting-based shape detection technique

&lt;img src="images/houghTransformCircle.jpg" width="1703" style="display: block; margin: auto;" /&gt;

.footnote[
[1] Hough [Hou62], [Image Source](https://commons.wikimedia.org/wiki/File:Circle\_Hough_transform\_of\_four\_points\_on\_a\_circle.jpg)
]

---
#2. Removing "minutiae" - Hough transform

- Hough transform detects circle center given a radius

- Count number of non-`NA` observations per row/column and find modes

&lt;img src="images/rowSumRadiusEstim.png" width="294" style="display: block; margin: auto;" /&gt;

???
- The Hough transform methom will detect the center of a circle in a matrix given a radius
 - The difficulty of this is that we don't *know* the radius ahead of time. Thus, it needs to be estimated
- To estimate the radius, we can count the number of non-NA (gray) elements per row/column of the matrix and determine when this count attains modes.
 - The image shown illustrates how the non-NA count changes with the rows/columns of the matrix.
 - We actually consider a moving average-smoothed version of the non-NA count to identify the modes.
 - The distance between the two modes provides an estimate for the diameter, and thus the radius.
---
#2. Removing "minutiae" - Hough transform

- Estimate radius values for various rotations of scan

.pull-left[
.center[All "votes"]
![](images/accumulator.gif)&lt;!-- --&gt;
]
.pull-right[
.center[Most popular "vote"]
![](images/houghTransformFilter.gif)&lt;!-- --&gt;
]

???
- We can obtain a number of estimates for the radius using the method described on the previous slide.
- We use each radius estimate to fit a Hough transform.
- Each frame of the gif on the left represents the "votes" cast for different centers in the image for a particular radius value
- Each frame of the gif on the right shows the location of the estimated firing pin circle - in particular which pixels are filtered out
---
#2. Removing "minutiae" - Hough transform

- Each radius value assigned "score" indicating strength of evidence

- Use Hough transform score to determine range of "confident" radius values

&lt;img src="images/houghScorePlot.png" width="676" style="display: block; margin: auto;" /&gt;

???
- We need some way to ultimately decide on a particular firing pin circle based on the estimates
- The Hough transform has a normalized score computed from the number of votes cast for a particular center
 - We can use these scores to quantify how "confident" in a particular center the Hough transform is
 - It's natural to take the center with the largest Hough score as the best estimate for a particular radius
- The max Hough score varies considerably depending on the radius considered.
 - The plot shows how the max Hough score varies by radius value
 - We can identify radius values where the max Hough score is "stable" and consistently high
 - The plot shows a range of values between radii 201 and 206 that have stable, high max Hough scores
 - We can then choose, say, the middle of this range of values as the final radius estimate
---
#2. Removing "minutiae" - Hough transform


&lt;img src="zemmelsCCpresentation_files/figure-html/unnamed-chunk-119-1.png" style="display: block; margin: auto;" /&gt;

---
#3. Gaussian filtering

- "Low-frequency", global structure due to, e.g., manufacturing specs

- "High-frequency" noise due to, e.g., scanning process

--

- Goal is to match cartridge cases based on *breech face impressions*, not on whether they share a manufacturer

- False positive rate likely to increase if these structures aren't removed

--

- Gaussian filtering reduces effects of large and small-scale structure

---
#3. Gaussian filtering

- Lowpass filtering = "smoothing"

    - Gaussian-weighted moving average

--

- Highpass filtering = "sharpening"

    - Subtract complementary lowpass-filtered matrix

--

- Bandpass filtering = highpass followed by lowpass

--

- Target signals of particular frequency by controlling Gaussian standard deviation

    - Larger s.d. = averaging over more observations = "smoother" output

---
#3. Gaussian filtering


```r
fadul1.1$surface.matrix &lt;- fadul1.1$surface.matrix %&gt;%
  cmcR::preProcess_gaussFilter(res = fadul1.1$header.info$incrementY,
                               wavelength = c(16,250),
                               filtertype = "bp")
```
&lt;img src="zemmelsCCpresentation_files/figure-html/unnamed-chunk-121-1.png" style="display: block; margin: auto;" /&gt;


---
#Pre-processing procedures conclusion

- Pre-processing procedures affect final results

- Methods used by some authors are still unavailable

    - Second-order robust Gaussian regression filter

    - Exact implementations may never be available

---
class: inverse, middle, center

# Cell-based comparison procedure

---
#Cross-correlation function

- For real-valued, bivariate funtions `\(f(x,y),g(x,y)\)` for `\(x,y \in \mathbb{R}\)`, *cross-correlation function* (CCF) is

`$$(f \star g)(x,y) := \int_{-\infty}^\infty \int_{-\infty}^\infty f(t,s) g(t + x,s + y)\ dtds$$`

--

- **Discrete analogue:** For two discrete, bivariate functions `\(A[m,n], B[m,n]\)` for `\(m,n \in \mathbb{Z}\)`, the CCF is

`$$(A \star B)[m,n] := \sum_{i = -\infty}^\infty \sum_{j = -\infty}^\infty A[i,j] B[i + m,j + n]$$`

--

- Think of `\(A[m,n]\)` as `\(m\)`th row and `\(n\)`th column of matrix `\(A\)`

---
#Cross-correlation theorem

- Calculating CCF by definition is computationally infeasible

--

- By the Cross-correlation theorem,
`$$A \star B = \mathcal{F}^{-1}\left(\overline{\mathcal{F}(A)} \cdot \mathcal{F}(B)\right)$$`
 - `\(\mathcal{F}(\cdot)\)` denotes Fourier transform
 
 - `\(\mathcal{F}^{-1}(\cdot)\)` denotes inverse Fourier transform

 - `\(\overline{f}\)` denotes complex conjugate of function `\(f\)`
 
 - multiplication on RHS is pointwise (Hadamard) multiplication

--

- *Fast Fourier Transform* drastically improves computational efficiency&lt;sup&gt;[1]&lt;/sup&gt;

.footnote[
[1] Tai and Eddy [TE18]
]

---
#Aligning by CCF

- CCF indicates how one matrix should be translated to align with another

`$$\text{CCF}_{\max} := \max_{m,n} \mathcal{F}^{-1}\left(\overline{\mathcal{F}(A)} \cdot \mathcal{F}(B)\right)[m,n]$$`

`$$[m^*,n^*] := \arg\max_{m,n} \mathcal{F}^{-1}\left(\overline{\mathcal{F}(A)} \cdot \mathcal{F}(B)\right)[m,n]$$`

--

- Note: this method requires replacing missing/`NA` values

 - `\(\text{CCF}_{\max}\)` values are often "deflated" for cartridge case scans
 
 - `\([m^*,n^*]\)` are often good estimates of "correct" translation parameters
 
--
 
- "True" `\(\text{CCF}_{\max}\)` value, without replacing `NA`s, can be determined after aligning matrices by `\([m^*,n^*]\)`

---
#Aligning by CCF - example

.pull-left[
&lt;img src="images/gaussianFilterInitialPlot.png" width="933" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="images/ccfExample_im2.png" width="933" style="display: block; margin: auto;" /&gt;
]

&lt;img src="images/ccfExample_map.png" width="395" style="display: block; margin: auto;" /&gt;

---
# Cell-based comparison procedure

&lt;img src="images/im1_im2_cellComparison.png" width="1135" style="display: block; margin: auto;" /&gt;

---
# Cell-based comparison procedure

1) Partition surface matrix 1 into grid of cells

--

2) Pair each cell with larger "region" in surface matrix 2 such that their center indices coincide.

--

3) For each rotation value:

- Rotate surface matrix 2 using linear interpolation scheme
  
--
    
- Remove from consideration cell/region pairs with too few observed values
  
--

- Shift and/or scale cells/regions (e.g., by respective average and/or standard deviation)
  
--
    
- Replace `NA` values with 0

--

- Calculate maximum cross-correlation function and associated `\((dx,dy)'\)` values using a FFT-based method


---
#Cell-based comparison procedure

3) For each rotation value:

- Using `\((dx,dy)'\)` values, calculate pairwise-complete correlation between cell and a cell-sized matrix extracted from surface matrix 2

&lt;img src="./images/ccfCellPairExample.png" width="583" style="display: block; margin: auto;" /&gt;

---
# Cell-based comparison procedure




```r
comparison1 &lt;- cmcR::cellCCF(fadul1.1,
                             fadul1.2,
                             thetas = seq(-30,30,by = 3),
                             cellNumHoriz = 8,
                             regionToCellProp = 4,
                             minObservedProp = .15,
                             centerCell = "individualCell",
                             scaleCell = "individualCell")
```



&lt;div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; "&gt;&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; cellNum &lt;/th&gt;
   &lt;th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"&gt; cellID &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; ccf &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; fft.ccf &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; dx &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; dy &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6394938 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3927187 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -34 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 219 - 290 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3892646 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3075786 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 35 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 291 - 362 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5069567 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3735940 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6505398 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.1941101 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -19 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 145, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7017533 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3479198 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -27 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 145, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7008966 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2533549 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -35 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 23 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 145, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8844661 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5132943 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 145, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5752828 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2184171 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 146 - 218, x = 1 - 73 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5632033 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2104306 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -21 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 36 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 146 - 218, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7311610 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3613980 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 31 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 23 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 146 - 218, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6649257 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4411520 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 146 - 218, x = 508 - 579 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5302772 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2675630 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -25 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 219 - 290, x = 1 - 73 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4253519 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.1691998 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 35 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 31 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 219 - 290, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7579754 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3856591 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -36 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 32 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 219 - 290, x = 508 - 579 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6065951 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2483960 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 33 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 291 - 363, x = 1 - 73 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3927668 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2007891 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -17 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 34 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 291 - 363, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4122892 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2161820 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 35 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 39 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 291 - 363, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7604274 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5117184 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 40 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 291 - 363, x = 508 - 579 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6213252 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2633999 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 23 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 41 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 1 - 73 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5510173 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3352693 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 42 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5758398 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2362528 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 43 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4972881 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.1663974 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 46 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6271995 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2104862 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 47 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3913027 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.1671559 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 35 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 48 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 508 - 579 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5294586 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2250945 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -14 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 50 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4600662 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2562463 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 51 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5135831 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2117756 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 52 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 219 - 290 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5623798 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3216802 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 53 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 291 - 362 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5309130 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2524229 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 54 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3617413 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.1328551 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 55 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5159072 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3090337 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 59 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 509 - 580, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6092757 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3071387 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 509 - 580, x = 219 - 290 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5362015 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2661880 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 61 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 509 - 580, x = 291 - 362 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5462265 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3301186 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -36 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 62 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 509 - 580, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6009329 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4198376 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;


---
class: inverse, middle, center

# Congruent Matching Cells logic

---
# Initially proposed method

- For each cell/region pair, determine alignment parameter estimates at which max CCF occurs

    - `\(\hat{\pmb{\beta}}_{\max,i}\)` for `\(i = 1,....,n\)` cells




---
#Initially proposed method

&lt;div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; "&gt;&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; cellNum &lt;/th&gt;
   &lt;th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"&gt; cellID &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; ccf &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; fft.ccf &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; dx &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; dy &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; theta &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7437182 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4507050 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -21 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 219 - 290 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4212396 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2807075 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 35 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 291 - 362 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6537729 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4631398 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6782151 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2006603 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -21 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 145, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8483261 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4057049 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 145, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7371514 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2561107 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -25 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -27 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 145, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8846892 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5304820 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 145, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6132623 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2569157 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 146 - 218, x = 1 - 73 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7543328 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2587314 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -21 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 146 - 218, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8425936 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3939444 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 23 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 146 - 218, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7553921 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4227012 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -18 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 146 - 218, x = 508 - 579 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7524552 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3703834 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 219 - 290, x = 1 - 73 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5147553 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2120541 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -21 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 31 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 219 - 290, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7836174 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4722309 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 32 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 219 - 290, x = 508 - 579 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6542447 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3130381 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 33 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 291 - 363, x = 1 - 73 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5412048 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2348436 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -15 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 34 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 291 - 363, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5750693 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3048763 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -19 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 39 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 291 - 363, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8061693 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5552012 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 40 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 291 - 363, x = 508 - 579 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6664582 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3786536 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 31 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 41 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 1 - 73 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5794391 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3676968 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -27 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 42 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6672655 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2651846 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 43 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5500753 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.1954360 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 46 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6933362 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2162226 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 47 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5265170 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.1487883 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 48 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 508 - 579 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6091791 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3336635 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 50 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5194628 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2702018 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -18 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 51 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5833238 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2332306 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 52 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 219 - 290 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6039683 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3461244 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -27 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 53 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 291 - 362 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5527599 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2492973 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -27 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 54 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4633644 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.1508883 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 55 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6316100 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3797026 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 59 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 509 - 580, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6624278 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4164043 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 509 - 580, x = 219 - 290 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6480568 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3506681 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -18 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 61 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 509 - 580, x = 291 - 362 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6340543 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3638141 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 62 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 509 - 580, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6374991 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4133909 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;

---
# Initially proposed method

- Determine "consensus" among these values, `\(\bar{\pmb{\beta}}\)`, by, e.g., taking their median

--

- Classify cell pair as "congruent matching" if associated alignment parameter estimates are close to consensual values

    - `\(\left\lvert\hat{\pmb{\beta}}_{\max,i} - \bar{\pmb{\beta}}\right\rvert \leq \pmb{T}\)` for thresholds `\(\pmb{T}\)`.

--

- Issue: initially proposed method only allows cell pairs to "vote" for a single alignment parameter combination

---
#Initially proposed method




&lt;div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; "&gt;&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; cellNum &lt;/th&gt;
   &lt;th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"&gt; cellID &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; ccf &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; fft.ccf &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; dx &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; dy &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; theta &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7437182 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4507050 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -21 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6782151 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2006603 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -21 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 145, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8483261 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4057049 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 145, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6132623 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2569157 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 146 - 218, x = 1 - 73 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7543328 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2587314 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -21 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 146 - 218, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8425936 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3939444 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 42 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6672655 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2651846 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 62 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 509 - 580, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6374991 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4133909 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;
 
---
# "Improved" method

- Cell pair may be highly similar at true `\(\pmb{\beta}\)`, but happened to not vote for it

--

- Use extracted features more advantageously &amp; perform comparisons in both "directions" &lt;sup&gt;[1]&lt;/sup&gt;

.footnote[
[1] Tong, Song, and Chu [TSC15]
]

--

- Count CMCs for each rotation value and identify CMC modes

    - Determine "high" CMC threshold, `\(\text{CMC}_{\text{high}} = \text{CMC}_{\max} - \tau\)` for some `\(\tau\)`
    
    - Find `\(\theta\)` value furthest from `\(\text{CMC}_{\max}\)` value with associated count greater than or equal to `\(\text{CMC}_{\text{high}}\)`

--

- If modes are too far from each other, then cell pair likely not a match

---
class: center
**Known match**
&lt;img src="images/kmCMCpertheta.png" width="446" style="display: block; margin: auto;" /&gt;

**Known non-match**
&lt;img src="images/knmCMCpertheta.png" width="446" style="display: block; margin: auto;" /&gt;


---
# "Improved" method

- If CMC modes are too far from each other, then assign CMC count based on initially proposed method

- Otherwise, count CMCs within `theta_thresh` of the CMC mode for both comparison directions, excluding replicates


```r
comparison2 &lt;- cmcR::cellCCF_bothDirections(fadul1.1,fadul1.2,
                                            thetas = seq(-30,30,by = 3),
                                            cellNumHoriz = 8,
                                            regionToCellProp = 4,
                                            minObservedProp = .15,
                                            centerCell = "individualCell",
                                            scaleCell = "individualCell")

cmc &lt;- comparison2 %&gt;%
  cmcR::cmcFilter_improved(consensus_function = median,
                           ccf_thresh = .6,
                           dx_thresh = 10,
                           theta_thresh = 3)
```


---
# "Improved" method


&lt;div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; "&gt;&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; cellNum &lt;/th&gt;
   &lt;th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"&gt; cellID &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; ccf &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; fft.ccf &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; dx &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; dy &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; theta &lt;/th&gt;
   &lt;th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"&gt; comparison &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7437182 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4507050 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 221 - 293 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7853873 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4948444 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_2to1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 294 - 366 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7735092 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4413118 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_2to1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 1 - 73, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6601086 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.1962291 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -27 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 145, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8483261 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4057049 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 145, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8761507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4696951 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 74 - 146, x = 440 - 512 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6946025 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3438510 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_2to1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 147 - 219, x = 1 - 74 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8276735 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3770155 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_2to1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 146 - 218, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8425936 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3939444 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 23 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 147 - 219, x = 440 - 512 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7678974 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2731040 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_2to1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 147 - 219, x = 513 - 585 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6083081 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3199504 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_2to1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 220 - 292, x = 1 - 74 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7826609 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4365688 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_2to1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 32 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 219 - 290, x = 508 - 579 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6411207 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2681380 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -27 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 33 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 293 - 365, x = 1 - 74 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6062741 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2538272 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_2to1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 34 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 293 - 365, x = 75 - 147 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6729459 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2479810 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_2to1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 39 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 291 - 363, x = 436 - 507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8061693 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5552012 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 40 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 291 - 363, x = 508 - 579 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6037441 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2091788 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 42 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 74 - 145 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6672655 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2651846 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 43 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 366 - 438, x = 148 - 220 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7259801 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2886908 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_2to1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 46 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 364 - 435, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6185624 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2421062 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 52 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 436 - 508, x = 219 - 290 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6039683 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3461244 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -27 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 55 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 439 - 511, x = 440 - 512 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6140005 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2896296 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_2to1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 59 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 509 - 580, x = 146 - 218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6225886 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3405154 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 62 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; y = 509 - 580, x = 363 - 435 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6374991 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4133909 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -24 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; comparison_1to2 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;


---

```r
cmcR::cmcPlot(fadul1.1,cmcDF = cmc$initialCMCs[[1]],method = "ggplot2")
```

&lt;img src="zemmelsCCpresentation_files/figure-html/unnamed-chunk-142-1.png" style="display: block; margin: auto;" /&gt;


```r
cmcR::cmcPlot(fadul1.1,cmcDF = cmc$finalCMCs,method = "ggplot2")
```

&lt;img src="zemmelsCCpresentation_files/figure-html/unnamed-chunk-143-1.png" style="display: block; margin: auto;" /&gt;


---
class: inverse, middle, center

# Results &amp; Discussion

---
#Results &amp; Discussion

- Fadul et al. cartridge case scans&lt;sup&gt;[1]&lt;/sup&gt;
    
    - 63 known match (KM) pairs, 717 known non-match (KNM) pairs

.footnote[
[1] Fadul, Hernandez, Stoiloff, and Sneh [Fad+11]
]

--

- Goal: Separation between KM and KNM CMC count distributions

--

- Sensitivity analysis under various pre, inter, and post-processing conditions

--

- Promising conditions are those used in this presentation

---
#Initially proposed method results

&lt;img src="images/initialCMCdistributions.png" width="395" style="display: block; margin: auto;" /&gt;

&lt;img src="images/initialCMCroc.png" width="395" style="display: block; margin: auto;" /&gt;

---
# Initially proposed method discussion

- Perfect classification achieved under other classification thresholds&lt;sup&gt;[1]&lt;/sup&gt;

.footnote[
[1] See appendix slides

[2] Tong, Song, Chu, and Thompson [Ton+14]
]

--

- Tong et al. achieve better separation of KM and KNM CMC distributions&lt;sup&gt;[2]&lt;/sup&gt;

 - Distance between max KNM count and min KM count
 
 - More informative diagnostic metrics may exist

---
#Improved method results

&lt;img src="images/finalCMCdistributions.png" width="395" style="display: block; margin: auto;" /&gt;

&lt;img src="images/finalCMCroc.png" width="395" style="display: block; margin: auto;" /&gt;

---
#Improved method discussion

- Improved method tends to assign higher CMC count to both KM and KNM

- More "false positive" CMCs assigned to KNM than other authors&lt;sup&gt;[1]&lt;/sup&gt;

.footnote[
[1] Chen, Song, Chu, Soons, and Zhao [Che+17]
]

---
# Results &amp; Discussion

- Perfect classification achieved using both methods

 - Dependent on filtering thresholds

--
 
- Other authors able to achieve better separation

--

- Explore small changes to methodology (e.g., parameter tuning)

---
class: inverse, middle, center

# Conclusions &amp; Future Work

---
#Conclusions

- Results indicate a close implementation of proposed CMC methods

- Main issues related to separation between KM and KNM distributions

- Tuning of pre, inter, and post-processing conditions will undoubtedly lead to results closer to those of other authors

- Conditions used in this presentation are current `cmcR` package defaults

---
#Future Work

- **Short-term:**

    - `R` Journal submission

    - `cmcR` package submission to CRAN

- **Longer-term:**

    - CMC method improvments:
     - techniques for dealing with `NA`s
     - better classification diagnostics
     - implementation of closed-source methods

    - Principled approach to quantifying and/or modeling similarity

---
#References
Chen, Z, J. Song, et al. (2017). "A convergence algorithm for correlation of breech face images based on the congruent matching cells
(CMC) method". In: _Forensic Science International_ 280, pp. 213-223. DOI:
[10.1016/j.forsciint.2017.08.033](https://doi.org/10.1016%2Fj.forsciint.2017.08.033).

Fadul, T., G. Hernandez, et al. (2011). _An Empirical Study to Improve the Scientific Foundation of Forensic Firearm and Tool Mark
Identification Utilizing 10 Consecutively Manufactured Slides_.

Fischler, M. A. and R. C. Bolles (1981). "Random Sample Consensus: A Paradigm for Model Fitting with Applications to Image Analysis
and Automated Cartography". In: _Commun. ACM_ 24.6, p. 381â€“395. DOI:
[10.1145/358669.358692](https://doi.org/10.1145%2F358669.358692).

Hough, P. (1962). _Method and means for recognizing complex patterns_. U.S. Patent 3,069,654

---
#References (cont'd.)

Song, J. (2013). "Proposed "NIST Ballistics Identification System (NBIS)" Based on 3D Topography Measurements on Correlation Cells".
In: _American Firearm and Tool Mark Examiners Journal_ 45.2, p. 11.

Tai, X. H. and W. F. Eddy (2018). "A Fully Automatic Method for Comparing Cartridge Case Images,". In: _Journal of Forensic Sciences_
63.2, pp. 440-448. DOI: [10.1111/1556-4029.13577](https://doi.org/10.1111%2F1556-4029.13577).

Tong, M, J. Song, et al. (2015). "An Improved Algorithm of Congruent Matching Cells (CMC) Method for Firearm Evidence
Identifications". In: _Journal of Research of the National Institute of Standards and Technology_ 120, p. 102. DOI:
[10.6028/jres.120.008](https://doi.org/10.6028%2Fjres.120.008).

Tong, M, J. Song, et al. (2014). "Fired Cartridge Case Identification Using Optical Images and the Congruent Matching Cells (CMC)
Method". In: _Journal of Research of the National Institute of Standards and Technology_ 119, p. 575. DOI:
[10.6028/jres.119.023](https://doi.org/10.6028%2Fjres.119.023).


---

class: center, middle

# Questions?

---
class: center, middle

# Thank you!

---
class: center, inverse, middle

# Appendix

---
# Initially proposed method perfect classif.

&lt;img src="images/initialCMCdistributions_perfectClassification.png" width="395" style="display: block; margin: auto;" /&gt;

&lt;img src="images/initialCMCroc_perfectClassification.png" width="395" style="display: block; margin: auto;" /&gt;

---
# Initial method CMC dist'n sensitivity

&lt;img src="images/initialCMCResidualsBP16_250plot_corr30-90_trans10-30_noAUC.png" width="634" style="display: block; margin: auto;" /&gt;

---
# Initial method ROC curve sensitivity

&lt;img src="images/roc_initialCMC_residualsBP16-250_corr30-90_trans10-30.png" width="634" style="display: block; margin: auto;" /&gt;


---
# Improved method CMC dist'n sensitivity

&lt;img src="images/cmcResidualsBP16_250_corr30-90_trans10-30_noAUC.png" width="634" style="display: block; margin: auto;" /&gt;

---
# Improved method ROC curve sensitivity

&lt;img src="images/roc_residualsBP16-250.png" width="634" style="display: block; margin: auto;" /&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
